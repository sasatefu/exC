library ieee;
use ieee.std_logic_1164.all;

type　D_Buff　is　array(0 to 1)　of　integer range 0 to 65535;

entity COUNT500ms is
	port(	count:	out std_logic_vector(15 downto 0);
			clock, pulse_in, reset:	in	std_logic);
end COUNT500ms;


architecture RTL of COUNT500ms is
	signal counter:	D_Buff;
	signal CNT500ms:	integer range 0 to (50000*500-1);
	signal flag: 		std_logic;
begin
process (clock)
begin
	if(clock'event and clock='1') then
		if(CNT500ms = (50000*500-1)) then  -- 1m sec
			CNT500ms <=0;
			count<=counter(flag);
			count(not(flag))=0;
			flag <= not(flag);
		else
			CNT500ms <= CNT500ms+1;
		end if;
	end if;
end process;

process (pulse_in, reset)
begin
	if(reset='1') then
		counter(0)=0;
		counter(1)=0;
	else if(pulse_in'event and pulse_in='1') then
			counter(flag)<=counter(flag)+1;
		end if;
	end if;
end process;
end RTL;
